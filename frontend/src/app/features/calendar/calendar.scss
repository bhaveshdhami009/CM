/* src/app/features/calendar/calendar.component.scss */

@use 'ui-components' as ui;

.calendar-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 20px;
  animation: fadeIn 0.4s ease-out;
}

// --- TOOLBAR ---
.calendar-toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 20px;
  border-bottom: 1px solid var(--border-color);
  flex-wrap: wrap;
  gap: 20px;
}

.toolbar-group {
  display: flex;
  align-items: center;
  gap: 15px;

  .page-title {
    margin: 0;
    font-size: 1.5rem;
    color: var(--text-color);
    margin-right: 10px;
  }
}

// Segmented Control Switcher
.view-switcher {
  display: flex;
  background-color: var(--bg-color);
  padding: 4px;
  border-radius: 8px;
  border: 1px solid var(--border-color);

  .switcher-btn {
    background: transparent;
    border: none;
    padding: 6px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text-secondary);
    transition: all 0.2s;

    &:hover { color: var(--text-color); }

    &.active {
      background-color: var(--primary-color);
      color: var(--accent-color);
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      font-weight: 600;
    }
  }
}

// --- DATE PICKER (CSS OVERLAY METHOD) ---
.date-picker-wrapper {
  position: relative;
  min-width: 180px;
  height: 38px;
  background-color: var(--bg-color);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  cursor: pointer;
  transition: border-color 0.2s;

  &:hover { 
    border-color: var(--accent-color); 
    background-color: var(--primary-color);
  }

  /* 1. The Hidden Input (Sits on top) */
  .native-date-input {
    position: absolute;
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%;
    opacity: 0; /* Invisible */
    z-index: 0; /* Top layer - captures clicks */
    cursor: pointer;
    
    -webkit-appearance: none;
  }

  /* 2. The Visible Label (Sits below) */
  .date-label {
    position: absolute;
    top: 0; 
    left: 0; 
    width: 100%; 
    height: 100%;
    z-index: 1; /* Bottom layer */
    
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 12px;
    
    color: var(--text-color);
    font-weight: 600;
    font-size: 0.95rem;

    i { color: var(--text-secondary); }
  }
}


// --- 1. MONTH GRID ---
.month-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  border-bottom: 1px solid var(--border-color);

  .weekday-header {
    padding: 10px;
    text-align: center;
    font-weight: 600;
    font-size: 0.85rem;
    color: var(--text-secondary);
    border-bottom: 1px solid var(--border-color);
    background-color: var(--bg-color);
    border-right: 1px solid var(--border-color);
    &:last-child { border-right: none; }
  }

  .day-cell {
    min-height: 140px;
    padding: 8px;
    border-right: 1px solid var(--border-color);
    border-bottom: 1px solid var(--border-color);
    cursor: pointer;
    background-color: var(--primary-color);
    transition: background-color 0.1s;

    &:nth-child(7n) { border-right: none; }
    &:hover { background-color: var(--bg-color); }

    &--muted {
      background-color: rgba(0,0,0,0.02);
      .day-number { opacity: 0.4; }
    }

    &--today {
      .day-number {
        background-color: var(--accent-color);
        color: #ffffff !important;
        width: 26px; height: 26px;
        border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        box-shadow: 0 2px 4px rgba(var(--accent-color-rgb), 0.4);
      }
    }

    .day-number {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 6px;
      color: var(--text-color);
    }
  }
}

// Month Events (Pills) - Base Styles
.month-events {
  display: flex; flex-direction: column; gap: 4px;

  .month-event-row {
    display: flex; align-items: center; gap: 6px;
    font-size: 0.75rem;
    color: var(--text-color);
    background-color: var(--bg-color);
    padding: 3px 6px;
    border-radius: 4px;
    border: 1px solid transparent;
    transition: all 0.2s;

    .dot {
      width: 6px; height: 6px; border-radius: 50%;
      background-color: var(--text-secondary);
      flex-shrink: 0;
    }

    .month-event-title {
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
      flex: 1;
      
      .case-name { opacity: 0.8; font-weight: 400; }
    }

    strong { font-weight: 700; }
  }

  .more-link {
    font-size: 0.75rem; font-weight: 600; color: var(--text-secondary); padding-left: 6px;
  }
}


// --- 2. WEEK GRID ---
.week-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  min-height: 600px;
  overflow-x: auto;

  .week-column {
    border-right: 1px solid var(--border-color);
    &:last-child { border-right: none; }

    &__header {
      padding: 15px 5px;
      text-align: center;
      border-bottom: 1px solid var(--border-color);
      background-color: var(--bg-color);
      cursor: pointer;
      
      .day-name { display: block; font-size: 0.8rem; color: var(--text-secondary); text-transform: uppercase; font-weight: 700; }
      .day-num { font-size: 1.25rem; font-weight: 700; color: var(--text-color); }

      &.today .day-num { color: var(--accent-color); }
      &:hover { background-color: rgba(var(--accent-color-rgb), 0.05); }
    }

    &__body {
      padding: 8px;
      display: flex; flex-direction: column; gap: 8px;
    }
  }
}

.week-card {
  background-color: var(--primary-color);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  padding: 8px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.03);

  .case-link {
    display: block; font-weight: 600; font-size: 0.8rem; color: var(--text-color);
    margin-bottom: 6px; text-decoration: none;
    &:hover { color: var(--accent-color); text-decoration: underline; }
  }

  .week-event-item {
    display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;
    padding: 4px 6px;
    border-radius: 4px;
    background-color: var(--bg-color); // Default background
    
    .time { font-size: 0.7rem; opacity: 0.8; }
    .type-text { font-size: 0.75rem; font-weight: 600; }
  }
}


// --- 3. DAY VIEW ---
.day-view {
  padding: 30px;
  max-width: 900px;
  margin: 0 auto;
}

.day-card {
  background-color: var(--bg-color);
  border: 1px solid var(--border-color);
  border-radius: 10px;
  margin-bottom: 20px;
  overflow: hidden;

  &__header {
    padding: 15px 20px;
    background-color: var(--primary-color);
    border-bottom: 1px solid var(--border-color);
    display: flex; justify-content: space-between; align-items: center;

    .title { font-weight: 700; font-size: 1.1rem; color: var(--text-color); text-decoration: none; &:hover{text-decoration: underline;} }
    .meta { font-size: 0.9rem; color: var(--text-secondary); margin-top: 2px; }
  }

  &__body { padding: 20px; }
}

.timeline-row {
  display: flex; gap: 20px; margin-bottom: 20px;
  &:last-child { margin-bottom: 0; }

  .time {
    min-width: 70px; font-weight: 600; color: var(--text-secondary); text-align: right; font-size: 0.9rem;
  }

  // Base styles for the details box
  .details {
    flex: 1;
    padding: 12px 15px;
    border-left: 4px solid var(--border-color); // Base border
    background-color: var(--primary-color);
    border-radius: 0 8px 8px 0; // Rounded right side
    transition: transform 0.2s;
    
    .top { display: flex; gap: 10px; align-items: center; margin-bottom: 6px; }
    .type-icon { font-size: 18px; color: var(--text-secondary); }
    .badge-title { font-weight: 700; margin-right: 10px; }
    
    .room { font-size: 0.85rem; opacity: 0.8; }
    .remarks { font-style: italic; opacity: 0.9; font-size: 0.95rem; margin-bottom: 4px; }
    .outcome { font-size: 0.9rem; font-weight: 600; }
  }
}


// =========================================================================
// --- EVENT STATUS & TYPE COLORS ---
// =========================================================================
/* 
   These classes are applied via [ngClass] in the HTML.
   They override the default backgrounds/colors defined above.
*/

// --- 1. PENDING (Yellow) ---
// Used when: Log is pending, or Task list has >0 pending items
.status-pending {
  background-color: var(--status-pending-bg) !important;
  color: var(--status-pending-text) !important;
  border-left-color: #ffc107 !important; // For Day View border
  
  // Specific Overrides for children
  .type-icon, strong, .badge-title { color: #856404; }
  .dot { background-color: #856404; opacity: 0.5; } 
}

// --- 2. DONE (Green) ---
// Used when: Log is done, or All tasks in a group are done
.status-done {
  background-color: var(--status-done-bg) !important;
  color: var(--status-done-text) !important;
  border-left-color: #28a745 !important;

  .type-icon, strong, .badge-title { color: #155724; }
  .dot { background-color: #155724; opacity: 0.5; }
}

// --- 3. HEARING (Accent/Blue) ---
// Used when: Hearing exists (and no pending logs)
.status-hearing {
  background-color: rgba(var(--accent-color-rgb), 0.15) !important;
  color: var(--accent-color) !important;
  border-left-color: var(--accent-color) !important;

  .type-icon, strong, .badge-title { color: var(--accent-color); }
  .dot { background-color: var(--accent-color); opacity: 0.5; }
}

// --- 4. EXECUTION (Teal) ---
// Used when: Execution exists (and no pending logs)
.status-execution {
  background-color: rgba(32, 201, 151, 0.15) !important; // Light Teal
  color: #0c855f !important; // Dark Teal
  border-left-color: #20c997 !important;

  .type-icon, strong, .badge-title { color: #0c855f; }
  .dot { background-color: #0c855f; opacity: 0.5; }
}

// --- 5. ADMIN / DEFAULT (Purple) ---
// Used when: Case Filed, Received, or general info
.status-admin {
  background-color: #e2d9f3 !important;
  color: #59359a !important;
  border-left-color: #6f42c1 !important;
  
  .type-icon, strong, .badge-title { color: #59359a; }
  .dot { background-color: #59359a; opacity: 0.5; }
}

@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }